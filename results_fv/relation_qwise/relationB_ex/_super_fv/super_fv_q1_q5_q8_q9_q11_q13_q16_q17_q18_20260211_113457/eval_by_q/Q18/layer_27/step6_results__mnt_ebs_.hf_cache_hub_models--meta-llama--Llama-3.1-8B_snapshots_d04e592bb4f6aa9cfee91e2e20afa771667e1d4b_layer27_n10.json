{
  "config": {
    "model": "/mnt/ebs/.hf_cache/hub/models--meta-llama--Llama-3.1-8B/snapshots/d04e592bb4f6aa9cfee91e2e20afa771667e1d4b",
    "model_spec": "llama3",
    "edit_layer": 27,
    "fv_source": "fv_global_resid",
    "seed": 0,
    "n_eval": 10,
    "requested_n_eval": 10,
    "answer_first_token": "auto",
    "alpha": 1.0,
    "dtype": "fp16",
    "device": "cuda",
    "batch_size": 1,
    "score_key": "mean_delta_p"
  },
  "fv": {
    "shape": [
      4096
    ],
    "norm": 14.671875
  },
  "summary": {
    "acc_base": 0.0,
    "acc_with": 0.0,
    "delta_acc": 0.0,
    "mean_logit_base": 4.84443359375,
    "mean_logit_with": 5.7345703125,
    "mean_delta_logit": 0.89013671875,
    "std_delta_logit": 0.34147508568871926,
    "mean_logprob_base": -8.568377208709716,
    "mean_logprob_with": -8.185642528533936,
    "mean_delta_logprob": 0.38273468017578127,
    "std_delta_logprob": 0.2811105450196143,
    "mean_p_base": 0.0003062820051127346,
    "mean_p_with": 0.0005390686754253692,
    "mean_delta_p": 0.00023278667031263468,
    "std_delta_p": 0.00041227667175116863
  },
  "per_qid": {
    "Q18": {
      "n_eval": 10,
      "acc_base": 0.0,
      "acc_with": 0.0,
      "delta_acc": 0.0,
      "mean_delta_logit": 0.89013671875,
      "mean_delta_logprob": 0.38273468017578127,
      "mean_delta_p": 0.00023278667031263468,
      "std_delta_logit": 0.34147508568871926,
      "std_delta_logprob": 0.2811105450196143,
      "std_delta_p": 0.00041227667175116863
    }
  },
  "matrix": {
    "__global__": {
      "Q18": 0.38273468017578127
    }
  },
  "metadata": {
    "model": "/mnt/ebs/.hf_cache/hub/models--meta-llama--Llama-3.1-8B/snapshots/d04e592bb4f6aa9cfee91e2e20afa771667e1d4b",
    "model_spec": "llama3",
    "edit_layer": 27,
    "injection_point": "residual",
    "slot": "query_predictive",
    "slot_name": "query_predictive",
    "slot_index_rule": "s=len(tokenize(prefix_str)); slot_index=s-1; target_id=input_ids[s]",
    "token_rule": "t_idx = seq_len - 1 (last token of prefix)",
    "score_key": "mean_delta_p",
    "heads": [
      {
        "layer": 13,
        "head": 27,
        "score_key": "mean_delta_p",
        "rank_score": 0.10754815472496881,
        "mean_delta_logprob": 0.8887832980685764,
        "mean_delta_p": 0.10754815472496881,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 17,
        "score_key": "mean_delta_p",
        "rank_score": 0.032186005910237625,
        "mean_delta_logprob": 0.2291970486111111,
        "mean_delta_p": 0.032186005910237625,
        "n_trials": 0
      },
      {
        "layer": 16,
        "head": 29,
        "score_key": "mean_delta_p",
        "rank_score": 0.02745819409688314,
        "mean_delta_logprob": 0.2036713324652778,
        "mean_delta_p": 0.02745819409688314,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 16,
        "score_key": "mean_delta_p",
        "rank_score": 0.01641016509797838,
        "mean_delta_logprob": 0.16058302137586805,
        "mean_delta_p": 0.01641016509797838,
        "n_trials": 0
      },
      {
        "layer": 10,
        "head": 5,
        "score_key": "mean_delta_p",
        "rank_score": 0.016350106398264567,
        "mean_delta_logprob": 0.18053114149305555,
        "mean_delta_p": 0.016350106398264567,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 1,
        "score_key": "mean_delta_p",
        "rank_score": 0.01494376262029012,
        "mean_delta_logprob": 0.13418382432725695,
        "mean_delta_p": 0.01494376262029012,
        "n_trials": 0
      },
      {
        "layer": 11,
        "head": 30,
        "score_key": "mean_delta_p",
        "rank_score": 0.010541312164730497,
        "mean_delta_logprob": 0.09505004882812501,
        "mean_delta_p": 0.010541312164730497,
        "n_trials": 0
      },
      {
        "layer": 13,
        "head": 6,
        "score_key": "mean_delta_p",
        "rank_score": 0.010219241778055827,
        "mean_delta_logprob": 0.12558085123697915,
        "mean_delta_p": 0.010219241778055827,
        "n_trials": 0
      },
      {
        "layer": 13,
        "head": 31,
        "score_key": "mean_delta_p",
        "rank_score": 0.01009435388776991,
        "mean_delta_logprob": 0.09321417914496528,
        "mean_delta_p": 0.01009435388776991,
        "n_trials": 0
      },
      {
        "layer": 10,
        "head": 7,
        "score_key": "mean_delta_p",
        "rank_score": 0.009312679237789577,
        "mean_delta_logprob": 0.08930291069878472,
        "mean_delta_p": 0.009312679237789577,
        "n_trials": 0
      },
      {
        "layer": 13,
        "head": 23,
        "score_key": "mean_delta_p",
        "rank_score": 0.009124122725592718,
        "mean_delta_logprob": 0.0658603244357639,
        "mean_delta_p": 0.009124122725592718,
        "n_trials": 0
      },
      {
        "layer": 14,
        "head": 29,
        "score_key": "mean_delta_p",
        "rank_score": 0.00906463305155436,
        "mean_delta_logprob": 0.08955959743923611,
        "mean_delta_p": 0.00906463305155436,
        "n_trials": 0
      },
      {
        "layer": 14,
        "head": 11,
        "score_key": "mean_delta_p",
        "rank_score": 0.007757936583624947,
        "mean_delta_logprob": 0.07462293836805556,
        "mean_delta_p": 0.007757936583624947,
        "n_trials": 0
      },
      {
        "layer": 11,
        "head": 29,
        "score_key": "mean_delta_p",
        "rank_score": 0.0071716941727532285,
        "mean_delta_logprob": 0.06530748155381944,
        "mean_delta_p": 0.0071716941727532285,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 19,
        "score_key": "mean_delta_p",
        "rank_score": 0.006395661301083035,
        "mean_delta_logprob": 0.0342828369140625,
        "mean_delta_p": 0.006395661301083035,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 2,
        "score_key": "mean_delta_p",
        "rank_score": 0.0062982251909044044,
        "mean_delta_logprob": 0.04206197102864583,
        "mean_delta_p": 0.0062982251909044044,
        "n_trials": 0
      },
      {
        "layer": 13,
        "head": 22,
        "score_key": "mean_delta_p",
        "rank_score": 0.006071037981245252,
        "mean_delta_logprob": 0.07497205946180556,
        "mean_delta_p": 0.006071037981245252,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 28,
        "score_key": "mean_delta_p",
        "rank_score": 0.005980883969200982,
        "mean_delta_logprob": 0.049569837782118056,
        "mean_delta_p": 0.005980883969200982,
        "n_trials": 0
      },
      {
        "layer": 31,
        "head": 14,
        "score_key": "mean_delta_p",
        "rank_score": 0.005951491461859809,
        "mean_delta_logprob": 0.04945929633246528,
        "mean_delta_p": 0.005951491461859809,
        "n_trials": 0
      },
      {
        "layer": 17,
        "head": 5,
        "score_key": "mean_delta_p",
        "rank_score": 0.005658464696672228,
        "mean_delta_logprob": 0.049692382812500005,
        "mean_delta_p": 0.005658464696672228,
        "n_trials": 0
      }
    ],
    "seed": 0,
    "n_eval": 10,
    "requested_n_eval": 10,
    "alpha": 1.0,
    "fv_source": "fv_global_resid",
    "fv_type": "global",
    "fv_source_qid": null,
    "eval_scope": "all_qids",
    "eval_qids": [
      "Q18"
    ],
    "config": {
      "n_heads": 32,
      "head_dim": 128,
      "resid_dim": 4096,
      "hook_type": "pre",
      "reshape": "resid_to_heads",
      "hook_target": "model.layers.{layer}.self_attn.o_proj",
      "dtype": "fp16",
      "device": "cuda",
      "batch_size": 1
    },
    "fv": {
      "shape": [
        4096
      ],
      "norm": 14.671875
    },
    "fv_meta": {
      "spec_name": "llama3",
      "model": "/mnt/ebs/.hf_cache/hub/models--meta-llama--Llama-3.1-8B/snapshots/d04e592bb4f6aa9cfee91e2e20afa771667e1d4b",
      "run_id_stepD": null,
      "heads": [
        {
          "layer": 13,
          "head": 27,
          "score_key": "mean_delta_p",
          "rank_score": 0.10754815472496881,
          "mean_delta_logprob": 0.8887832980685764,
          "mean_delta_p": 0.10754815472496881,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 17,
          "score_key": "mean_delta_p",
          "rank_score": 0.032186005910237625,
          "mean_delta_logprob": 0.2291970486111111,
          "mean_delta_p": 0.032186005910237625,
          "n_trials": 0
        },
        {
          "layer": 16,
          "head": 29,
          "score_key": "mean_delta_p",
          "rank_score": 0.02745819409688314,
          "mean_delta_logprob": 0.2036713324652778,
          "mean_delta_p": 0.02745819409688314,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 16,
          "score_key": "mean_delta_p",
          "rank_score": 0.01641016509797838,
          "mean_delta_logprob": 0.16058302137586805,
          "mean_delta_p": 0.01641016509797838,
          "n_trials": 0
        },
        {
          "layer": 10,
          "head": 5,
          "score_key": "mean_delta_p",
          "rank_score": 0.016350106398264567,
          "mean_delta_logprob": 0.18053114149305555,
          "mean_delta_p": 0.016350106398264567,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 1,
          "score_key": "mean_delta_p",
          "rank_score": 0.01494376262029012,
          "mean_delta_logprob": 0.13418382432725695,
          "mean_delta_p": 0.01494376262029012,
          "n_trials": 0
        },
        {
          "layer": 11,
          "head": 30,
          "score_key": "mean_delta_p",
          "rank_score": 0.010541312164730497,
          "mean_delta_logprob": 0.09505004882812501,
          "mean_delta_p": 0.010541312164730497,
          "n_trials": 0
        },
        {
          "layer": 13,
          "head": 6,
          "score_key": "mean_delta_p",
          "rank_score": 0.010219241778055827,
          "mean_delta_logprob": 0.12558085123697915,
          "mean_delta_p": 0.010219241778055827,
          "n_trials": 0
        },
        {
          "layer": 13,
          "head": 31,
          "score_key": "mean_delta_p",
          "rank_score": 0.01009435388776991,
          "mean_delta_logprob": 0.09321417914496528,
          "mean_delta_p": 0.01009435388776991,
          "n_trials": 0
        },
        {
          "layer": 10,
          "head": 7,
          "score_key": "mean_delta_p",
          "rank_score": 0.009312679237789577,
          "mean_delta_logprob": 0.08930291069878472,
          "mean_delta_p": 0.009312679237789577,
          "n_trials": 0
        },
        {
          "layer": 13,
          "head": 23,
          "score_key": "mean_delta_p",
          "rank_score": 0.009124122725592718,
          "mean_delta_logprob": 0.0658603244357639,
          "mean_delta_p": 0.009124122725592718,
          "n_trials": 0
        },
        {
          "layer": 14,
          "head": 29,
          "score_key": "mean_delta_p",
          "rank_score": 0.00906463305155436,
          "mean_delta_logprob": 0.08955959743923611,
          "mean_delta_p": 0.00906463305155436,
          "n_trials": 0
        },
        {
          "layer": 14,
          "head": 11,
          "score_key": "mean_delta_p",
          "rank_score": 0.007757936583624947,
          "mean_delta_logprob": 0.07462293836805556,
          "mean_delta_p": 0.007757936583624947,
          "n_trials": 0
        },
        {
          "layer": 11,
          "head": 29,
          "score_key": "mean_delta_p",
          "rank_score": 0.0071716941727532285,
          "mean_delta_logprob": 0.06530748155381944,
          "mean_delta_p": 0.0071716941727532285,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 19,
          "score_key": "mean_delta_p",
          "rank_score": 0.006395661301083035,
          "mean_delta_logprob": 0.0342828369140625,
          "mean_delta_p": 0.006395661301083035,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 2,
          "score_key": "mean_delta_p",
          "rank_score": 0.0062982251909044044,
          "mean_delta_logprob": 0.04206197102864583,
          "mean_delta_p": 0.0062982251909044044,
          "n_trials": 0
        },
        {
          "layer": 13,
          "head": 22,
          "score_key": "mean_delta_p",
          "rank_score": 0.006071037981245252,
          "mean_delta_logprob": 0.07497205946180556,
          "mean_delta_p": 0.006071037981245252,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 28,
          "score_key": "mean_delta_p",
          "rank_score": 0.005980883969200982,
          "mean_delta_logprob": 0.049569837782118056,
          "mean_delta_p": 0.005980883969200982,
          "n_trials": 0
        },
        {
          "layer": 31,
          "head": 14,
          "score_key": "mean_delta_p",
          "rank_score": 0.005951491461859809,
          "mean_delta_logprob": 0.04945929633246528,
          "mean_delta_p": 0.005951491461859809,
          "n_trials": 0
        },
        {
          "layer": 17,
          "head": 5,
          "score_key": "mean_delta_p",
          "rank_score": 0.005658464696672228,
          "mean_delta_logprob": 0.049692382812500005,
          "mean_delta_p": 0.005658464696672228,
          "n_trials": 0
        }
      ],
      "token_position_rule": "t_idx = seq_len - 1 (last token of prefix)"
    },
    "timestamp": "2026-02-11T13:04:47.985378Z"
  },
  "results": [
    {
      "idx": 0,
      "q_id": "Q18",
      "prompt": "Q: horse\nA:",
      "answer": " hay",
      "target_id": 18137,
      "target_token": "\u0120hay",
      "leading_space": true,
      "used_id": 18137,
      "used_token": "\u0120hay",
      "pred_id_base": 15580,
      "pred_id_with": 15580,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 4.87109375,
      "logit_with": 6.19921875,
      "delta_logit": 1.328125,
      "logprob_base": -8.38855266571045,
      "logprob_with": -7.819685935974121,
      "delta_logprob": 0.5688667297363281,
      "p_base": 0.0002274562430102378,
      "p_with": 0.00040174784953705966,
      "delta_p": 0.00017429160652682185
    },
    {
      "idx": 1,
      "q_id": "Q18",
      "prompt": "Q: vegetarian\nA:",
      "answer": " vegetable",
      "target_id": 36581,
      "target_token": "\u0120vegetable",
      "leading_space": true,
      "used_id": 36581,
      "used_token": "\u0120vegetable",
      "pred_id_base": 7566,
      "pred_id_with": 7566,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 6.56640625,
      "logit_with": 7.3359375,
      "delta_logit": 0.76953125,
      "logprob_base": -8.311836242675781,
      "logprob_with": -7.989075660705566,
      "delta_logprob": 0.32276058197021484,
      "p_base": 0.00024559267330914736,
      "p_with": 0.0003391474310774356,
      "delta_p": 9.355475776828825e-05
    },
    {
      "idx": 2,
      "q_id": "Q18",
      "prompt": "Q: rabbit\nA:",
      "answer": " carrot",
      "target_id": 75294,
      "target_token": "\u0120carrot",
      "leading_space": true,
      "used_id": 75294,
      "used_token": "\u0120carrot",
      "pred_id_base": 39824,
      "pred_id_with": 39824,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 5.58984375,
      "logit_with": 6.515625,
      "delta_logit": 0.92578125,
      "logprob_base": -8.37348461151123,
      "logprob_with": -7.807991027832031,
      "delta_logprob": 0.5654935836791992,
      "p_base": 0.0002309095289092511,
      "p_with": 0.00040647381683811545,
      "delta_p": 0.00017556428792886436
    },
    {
      "idx": 3,
      "q_id": "Q18",
      "prompt": "Q: sheep\nA:",
      "answer": " clover",
      "target_id": 5405,
      "target_token": "\u0120clo",
      "leading_space": true,
      "used_id": 5405,
      "used_token": "\u0120clo",
      "pred_id_base": 33012,
      "pred_id_with": 33012,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 4.3046875,
      "logit_with": 4.296875,
      "delta_logit": -0.0078125,
      "logprob_base": -10.058971405029297,
      "logprob_with": -10.385482788085938,
      "delta_logprob": -0.3265113830566406,
      "p_base": 4.280004577594809e-05,
      "p_with": 3.087749792030081e-05,
      "delta_p": -1.192254785564728e-05
    },
    {
      "idx": 4,
      "q_id": "Q18",
      "prompt": "Q: baby\nA:",
      "answer": " milk",
      "target_id": 14403,
      "target_token": "\u0120milk",
      "leading_space": true,
      "used_id": 14403,
      "used_token": "\u0120milk",
      "pred_id_base": 8945,
      "pred_id_with": 8945,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 3.91796875,
      "logit_with": 4.94140625,
      "delta_logit": 1.0234375,
      "logprob_base": -8.745903015136719,
      "logprob_with": -8.304920196533203,
      "delta_logprob": 0.4409828186035156,
      "p_base": 0.00015911186346784234,
      "p_with": 0.00024729708093218505,
      "delta_p": 8.818521746434271e-05
    },
    {
      "idx": 5,
      "q_id": "Q18",
      "prompt": "Q: cat\nA:",
      "answer": " fish",
      "target_id": 7795,
      "target_token": "\u0120fish",
      "leading_space": true,
      "used_id": 7795,
      "used_token": "\u0120fish",
      "pred_id_base": 8415,
      "pred_id_with": 8415,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 4.50390625,
      "logit_with": 5.48828125,
      "delta_logit": 0.984375,
      "logprob_base": -8.13451099395752,
      "logprob_with": -7.673089981079102,
      "delta_logprob": 0.46142101287841797,
      "p_base": 0.0002932423958554864,
      "p_with": 0.0004651782219298184,
      "delta_p": 0.000171935826074332
    },
    {
      "idx": 6,
      "q_id": "Q18",
      "prompt": "Q: mouse\nA:",
      "answer": " cheese",
      "target_id": 17604,
      "target_token": "\u0120cheese",
      "leading_space": true,
      "used_id": 17604,
      "used_token": "\u0120cheese",
      "pred_id_base": 578,
      "pred_id_with": 8814,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 3.6875,
      "logit_with": 4.484375,
      "delta_logit": 0.796875,
      "logprob_base": -8.953429222106934,
      "logprob_with": -8.717158317565918,
      "delta_logprob": 0.23627090454101562,
      "p_base": 0.00012929302465636283,
      "p_with": 0.00016375187260564417,
      "delta_p": 3.4458847949281335e-05
    },
    {
      "idx": 7,
      "q_id": "Q18",
      "prompt": "Q: monkey\nA:",
      "answer": " banana",
      "target_id": 44196,
      "target_token": "\u0120banana",
      "leading_space": true,
      "used_id": 44196,
      "used_token": "\u0120banana",
      "pred_id_base": 220,
      "pred_id_with": 220,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 7.35546875,
      "logit_with": 8.328125,
      "delta_logit": 0.97265625,
      "logprob_base": -6.661330223083496,
      "logprob_with": -5.901763916015625,
      "delta_logprob": 0.7595663070678711,
      "p_base": 0.0012794432695955038,
      "p_with": 0.0027346170973032713,
      "delta_p": 0.0014551738277077675
    },
    {
      "idx": 8,
      "q_id": "Q18",
      "prompt": "Q: human\nA:",
      "answer": " cheese",
      "target_id": 17604,
      "target_token": "\u0120cheese",
      "leading_space": true,
      "used_id": 17604,
      "used_token": "\u0120cheese",
      "pred_id_base": 3823,
      "pred_id_with": 220,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 1.7802734375,
      "logit_with": 3.001953125,
      "delta_logit": 1.2216796875,
      "logprob_base": -10.282247543334961,
      "logprob_with": -9.738128662109375,
      "delta_logprob": 0.5441188812255859,
      "p_base": 3.4235497878398746e-05,
      "p_with": 5.899082316318527e-05,
      "delta_p": 2.4755325284786522e-05
    },
    {
      "idx": 9,
      "q_id": "Q18",
      "prompt": "Q: cow\nA:",
      "answer": " grass",
      "target_id": 16763,
      "target_token": "\u0120grass",
      "leading_space": true,
      "used_id": 16763,
      "used_token": "\u0120grass",
      "pred_id_base": 19923,
      "pred_id_with": 19923,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 5.8671875,
      "logit_with": 6.75390625,
      "delta_logit": 0.88671875,
      "logprob_base": -7.773506164550781,
      "logprob_with": -7.519128799438477,
      "delta_logprob": 0.2543773651123047,
      "p_base": 0.00042073550866916776,
      "p_with": 0.0005426050629466772,
      "delta_p": 0.00012186955427750945
    }
  ]
}