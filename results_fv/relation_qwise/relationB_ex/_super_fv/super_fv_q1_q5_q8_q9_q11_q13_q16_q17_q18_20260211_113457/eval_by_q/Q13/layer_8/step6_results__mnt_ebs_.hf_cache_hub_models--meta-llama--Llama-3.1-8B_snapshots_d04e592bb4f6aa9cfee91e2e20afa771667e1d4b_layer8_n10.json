{
  "config": {
    "model": "/mnt/ebs/.hf_cache/hub/models--meta-llama--Llama-3.1-8B/snapshots/d04e592bb4f6aa9cfee91e2e20afa771667e1d4b",
    "model_spec": "llama3",
    "edit_layer": 8,
    "fv_source": "fv_global_resid",
    "seed": 0,
    "n_eval": 10,
    "requested_n_eval": 10,
    "answer_first_token": "auto",
    "alpha": 1.0,
    "dtype": "fp16",
    "device": "cuda",
    "batch_size": 1,
    "score_key": "mean_delta_p"
  },
  "fv": {
    "shape": [
      4096
    ],
    "norm": 14.671875
  },
  "summary": {
    "acc_base": 0.1,
    "acc_with": 0.3,
    "delta_acc": 0.19999999999999998,
    "mean_logit_base": 9.5408203125,
    "mean_logit_with": 12.5373046875,
    "mean_delta_logit": 2.996484375,
    "std_delta_logit": 1.4238658474083912,
    "mean_logprob_base": -5.262996768951416,
    "mean_logprob_with": -3.5259652137756348,
    "mean_delta_logprob": 1.7370315551757813,
    "std_delta_logprob": 1.113859918327005,
    "mean_p_base": 0.018350403838212515,
    "mean_p_with": 0.10961238594691167,
    "mean_delta_p": 0.09126198210869915,
    "std_delta_p": 0.13047759134734843
  },
  "per_qid": {
    "Q13": {
      "n_eval": 10,
      "acc_base": 0.1,
      "acc_with": 0.3,
      "delta_acc": 0.2,
      "mean_delta_logit": 2.996484375,
      "mean_delta_logprob": 1.7370315551757813,
      "mean_delta_p": 0.09126198210869915,
      "std_delta_logit": 1.4238658474083912,
      "std_delta_logprob": 1.113859918327005,
      "std_delta_p": 0.13047759134734843
    }
  },
  "matrix": {
    "__global__": {
      "Q13": 1.7370315551757813
    }
  },
  "metadata": {
    "model": "/mnt/ebs/.hf_cache/hub/models--meta-llama--Llama-3.1-8B/snapshots/d04e592bb4f6aa9cfee91e2e20afa771667e1d4b",
    "model_spec": "llama3",
    "edit_layer": 8,
    "injection_point": "residual",
    "slot": "query_predictive",
    "slot_name": "query_predictive",
    "slot_index_rule": "s=len(tokenize(prefix_str)); slot_index=s-1; target_id=input_ids[s]",
    "token_rule": "t_idx = seq_len - 1 (last token of prefix)",
    "score_key": "mean_delta_p",
    "heads": [
      {
        "layer": 13,
        "head": 27,
        "score_key": "mean_delta_p",
        "rank_score": 0.10754815472496881,
        "mean_delta_logprob": 0.8887832980685764,
        "mean_delta_p": 0.10754815472496881,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 17,
        "score_key": "mean_delta_p",
        "rank_score": 0.032186005910237625,
        "mean_delta_logprob": 0.2291970486111111,
        "mean_delta_p": 0.032186005910237625,
        "n_trials": 0
      },
      {
        "layer": 16,
        "head": 29,
        "score_key": "mean_delta_p",
        "rank_score": 0.02745819409688314,
        "mean_delta_logprob": 0.2036713324652778,
        "mean_delta_p": 0.02745819409688314,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 16,
        "score_key": "mean_delta_p",
        "rank_score": 0.01641016509797838,
        "mean_delta_logprob": 0.16058302137586805,
        "mean_delta_p": 0.01641016509797838,
        "n_trials": 0
      },
      {
        "layer": 10,
        "head": 5,
        "score_key": "mean_delta_p",
        "rank_score": 0.016350106398264567,
        "mean_delta_logprob": 0.18053114149305555,
        "mean_delta_p": 0.016350106398264567,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 1,
        "score_key": "mean_delta_p",
        "rank_score": 0.01494376262029012,
        "mean_delta_logprob": 0.13418382432725695,
        "mean_delta_p": 0.01494376262029012,
        "n_trials": 0
      },
      {
        "layer": 11,
        "head": 30,
        "score_key": "mean_delta_p",
        "rank_score": 0.010541312164730497,
        "mean_delta_logprob": 0.09505004882812501,
        "mean_delta_p": 0.010541312164730497,
        "n_trials": 0
      },
      {
        "layer": 13,
        "head": 6,
        "score_key": "mean_delta_p",
        "rank_score": 0.010219241778055827,
        "mean_delta_logprob": 0.12558085123697915,
        "mean_delta_p": 0.010219241778055827,
        "n_trials": 0
      },
      {
        "layer": 13,
        "head": 31,
        "score_key": "mean_delta_p",
        "rank_score": 0.01009435388776991,
        "mean_delta_logprob": 0.09321417914496528,
        "mean_delta_p": 0.01009435388776991,
        "n_trials": 0
      },
      {
        "layer": 10,
        "head": 7,
        "score_key": "mean_delta_p",
        "rank_score": 0.009312679237789577,
        "mean_delta_logprob": 0.08930291069878472,
        "mean_delta_p": 0.009312679237789577,
        "n_trials": 0
      },
      {
        "layer": 13,
        "head": 23,
        "score_key": "mean_delta_p",
        "rank_score": 0.009124122725592718,
        "mean_delta_logprob": 0.0658603244357639,
        "mean_delta_p": 0.009124122725592718,
        "n_trials": 0
      },
      {
        "layer": 14,
        "head": 29,
        "score_key": "mean_delta_p",
        "rank_score": 0.00906463305155436,
        "mean_delta_logprob": 0.08955959743923611,
        "mean_delta_p": 0.00906463305155436,
        "n_trials": 0
      },
      {
        "layer": 14,
        "head": 11,
        "score_key": "mean_delta_p",
        "rank_score": 0.007757936583624947,
        "mean_delta_logprob": 0.07462293836805556,
        "mean_delta_p": 0.007757936583624947,
        "n_trials": 0
      },
      {
        "layer": 11,
        "head": 29,
        "score_key": "mean_delta_p",
        "rank_score": 0.0071716941727532285,
        "mean_delta_logprob": 0.06530748155381944,
        "mean_delta_p": 0.0071716941727532285,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 19,
        "score_key": "mean_delta_p",
        "rank_score": 0.006395661301083035,
        "mean_delta_logprob": 0.0342828369140625,
        "mean_delta_p": 0.006395661301083035,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 2,
        "score_key": "mean_delta_p",
        "rank_score": 0.0062982251909044044,
        "mean_delta_logprob": 0.04206197102864583,
        "mean_delta_p": 0.0062982251909044044,
        "n_trials": 0
      },
      {
        "layer": 13,
        "head": 22,
        "score_key": "mean_delta_p",
        "rank_score": 0.006071037981245252,
        "mean_delta_logprob": 0.07497205946180556,
        "mean_delta_p": 0.006071037981245252,
        "n_trials": 0
      },
      {
        "layer": 15,
        "head": 28,
        "score_key": "mean_delta_p",
        "rank_score": 0.005980883969200982,
        "mean_delta_logprob": 0.049569837782118056,
        "mean_delta_p": 0.005980883969200982,
        "n_trials": 0
      },
      {
        "layer": 31,
        "head": 14,
        "score_key": "mean_delta_p",
        "rank_score": 0.005951491461859809,
        "mean_delta_logprob": 0.04945929633246528,
        "mean_delta_p": 0.005951491461859809,
        "n_trials": 0
      },
      {
        "layer": 17,
        "head": 5,
        "score_key": "mean_delta_p",
        "rank_score": 0.005658464696672228,
        "mean_delta_logprob": 0.049692382812500005,
        "mean_delta_p": 0.005658464696672228,
        "n_trials": 0
      }
    ],
    "seed": 0,
    "n_eval": 10,
    "requested_n_eval": 10,
    "alpha": 1.0,
    "fv_source": "fv_global_resid",
    "fv_type": "global",
    "fv_source_qid": null,
    "eval_scope": "all_qids",
    "eval_qids": [
      "Q13"
    ],
    "config": {
      "n_heads": 32,
      "head_dim": 128,
      "resid_dim": 4096,
      "hook_type": "pre",
      "reshape": "resid_to_heads",
      "hook_target": "model.layers.{layer}.self_attn.o_proj",
      "dtype": "fp16",
      "device": "cuda",
      "batch_size": 1
    },
    "fv": {
      "shape": [
        4096
      ],
      "norm": 14.671875
    },
    "fv_meta": {
      "spec_name": "llama3",
      "model": "/mnt/ebs/.hf_cache/hub/models--meta-llama--Llama-3.1-8B/snapshots/d04e592bb4f6aa9cfee91e2e20afa771667e1d4b",
      "run_id_stepD": null,
      "heads": [
        {
          "layer": 13,
          "head": 27,
          "score_key": "mean_delta_p",
          "rank_score": 0.10754815472496881,
          "mean_delta_logprob": 0.8887832980685764,
          "mean_delta_p": 0.10754815472496881,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 17,
          "score_key": "mean_delta_p",
          "rank_score": 0.032186005910237625,
          "mean_delta_logprob": 0.2291970486111111,
          "mean_delta_p": 0.032186005910237625,
          "n_trials": 0
        },
        {
          "layer": 16,
          "head": 29,
          "score_key": "mean_delta_p",
          "rank_score": 0.02745819409688314,
          "mean_delta_logprob": 0.2036713324652778,
          "mean_delta_p": 0.02745819409688314,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 16,
          "score_key": "mean_delta_p",
          "rank_score": 0.01641016509797838,
          "mean_delta_logprob": 0.16058302137586805,
          "mean_delta_p": 0.01641016509797838,
          "n_trials": 0
        },
        {
          "layer": 10,
          "head": 5,
          "score_key": "mean_delta_p",
          "rank_score": 0.016350106398264567,
          "mean_delta_logprob": 0.18053114149305555,
          "mean_delta_p": 0.016350106398264567,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 1,
          "score_key": "mean_delta_p",
          "rank_score": 0.01494376262029012,
          "mean_delta_logprob": 0.13418382432725695,
          "mean_delta_p": 0.01494376262029012,
          "n_trials": 0
        },
        {
          "layer": 11,
          "head": 30,
          "score_key": "mean_delta_p",
          "rank_score": 0.010541312164730497,
          "mean_delta_logprob": 0.09505004882812501,
          "mean_delta_p": 0.010541312164730497,
          "n_trials": 0
        },
        {
          "layer": 13,
          "head": 6,
          "score_key": "mean_delta_p",
          "rank_score": 0.010219241778055827,
          "mean_delta_logprob": 0.12558085123697915,
          "mean_delta_p": 0.010219241778055827,
          "n_trials": 0
        },
        {
          "layer": 13,
          "head": 31,
          "score_key": "mean_delta_p",
          "rank_score": 0.01009435388776991,
          "mean_delta_logprob": 0.09321417914496528,
          "mean_delta_p": 0.01009435388776991,
          "n_trials": 0
        },
        {
          "layer": 10,
          "head": 7,
          "score_key": "mean_delta_p",
          "rank_score": 0.009312679237789577,
          "mean_delta_logprob": 0.08930291069878472,
          "mean_delta_p": 0.009312679237789577,
          "n_trials": 0
        },
        {
          "layer": 13,
          "head": 23,
          "score_key": "mean_delta_p",
          "rank_score": 0.009124122725592718,
          "mean_delta_logprob": 0.0658603244357639,
          "mean_delta_p": 0.009124122725592718,
          "n_trials": 0
        },
        {
          "layer": 14,
          "head": 29,
          "score_key": "mean_delta_p",
          "rank_score": 0.00906463305155436,
          "mean_delta_logprob": 0.08955959743923611,
          "mean_delta_p": 0.00906463305155436,
          "n_trials": 0
        },
        {
          "layer": 14,
          "head": 11,
          "score_key": "mean_delta_p",
          "rank_score": 0.007757936583624947,
          "mean_delta_logprob": 0.07462293836805556,
          "mean_delta_p": 0.007757936583624947,
          "n_trials": 0
        },
        {
          "layer": 11,
          "head": 29,
          "score_key": "mean_delta_p",
          "rank_score": 0.0071716941727532285,
          "mean_delta_logprob": 0.06530748155381944,
          "mean_delta_p": 0.0071716941727532285,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 19,
          "score_key": "mean_delta_p",
          "rank_score": 0.006395661301083035,
          "mean_delta_logprob": 0.0342828369140625,
          "mean_delta_p": 0.006395661301083035,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 2,
          "score_key": "mean_delta_p",
          "rank_score": 0.0062982251909044044,
          "mean_delta_logprob": 0.04206197102864583,
          "mean_delta_p": 0.0062982251909044044,
          "n_trials": 0
        },
        {
          "layer": 13,
          "head": 22,
          "score_key": "mean_delta_p",
          "rank_score": 0.006071037981245252,
          "mean_delta_logprob": 0.07497205946180556,
          "mean_delta_p": 0.006071037981245252,
          "n_trials": 0
        },
        {
          "layer": 15,
          "head": 28,
          "score_key": "mean_delta_p",
          "rank_score": 0.005980883969200982,
          "mean_delta_logprob": 0.049569837782118056,
          "mean_delta_p": 0.005980883969200982,
          "n_trials": 0
        },
        {
          "layer": 31,
          "head": 14,
          "score_key": "mean_delta_p",
          "rank_score": 0.005951491461859809,
          "mean_delta_logprob": 0.04945929633246528,
          "mean_delta_p": 0.005951491461859809,
          "n_trials": 0
        },
        {
          "layer": 17,
          "head": 5,
          "score_key": "mean_delta_p",
          "rank_score": 0.005658464696672228,
          "mean_delta_logprob": 0.049692382812500005,
          "mean_delta_p": 0.005658464696672228,
          "n_trials": 0
        }
      ],
      "token_position_rule": "t_idx = seq_len - 1 (last token of prefix)"
    },
    "timestamp": "2026-02-11T12:28:29.241521Z"
  },
  "results": [
    {
      "idx": 0,
      "q_id": "Q13",
      "prompt": "Q: Lamb\nA:",
      "answer": " Sheep",
      "target_id": 84008,
      "target_token": "\u0120Sheep",
      "leading_space": true,
      "used_id": 84008,
      "used_token": "\u0120Sheep",
      "pred_id_base": 32402,
      "pred_id_with": 386,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 12.046875,
      "logit_with": 13.6640625,
      "delta_logit": 1.6171875,
      "logprob_base": -3.4950428009033203,
      "logprob_with": -2.9647159576416016,
      "delta_logprob": 0.5303268432617188,
      "p_base": 0.030347449705004692,
      "p_with": 0.05157511681318283,
      "delta_p": 0.02122766710817814
    },
    {
      "idx": 1,
      "q_id": "Q13",
      "prompt": "Q: Boy\nA:",
      "answer": " Man",
      "target_id": 2418,
      "target_token": "\u0120Man",
      "leading_space": true,
      "used_id": 2418,
      "used_token": "\u0120Man",
      "pred_id_base": 11617,
      "pred_id_with": 11617,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 9.2421875,
      "logit_with": 13.8984375,
      "delta_logit": 4.65625,
      "logprob_base": -4.259387016296387,
      "logprob_with": -3.389965057373047,
      "delta_logprob": 0.8694219589233398,
      "p_base": 0.014130962081253529,
      "p_with": 0.03370985388755798,
      "delta_p": 0.019578891806304455
    },
    {
      "idx": 2,
      "q_id": "Q13",
      "prompt": "Q: Piglet\nA:",
      "answer": " Pig",
      "target_id": 49654,
      "target_token": "\u0120Pig",
      "leading_space": true,
      "used_id": 49654,
      "used_token": "\u0120Pig",
      "pred_id_base": 49654,
      "pred_id_with": 49654,
      "accuracy_base": 1.0,
      "accuracy_with": 1.0,
      "delta_acc": 0.0,
      "logit_base": 12.375,
      "logit_with": 13.3828125,
      "delta_logit": 1.0078125,
      "logprob_base": -2.4898109436035156,
      "logprob_with": -2.1266613006591797,
      "delta_logprob": 0.36314964294433594,
      "p_base": 0.08292564004659653,
      "p_with": 0.11923471093177795,
      "delta_p": 0.03630907088518143
    },
    {
      "idx": 3,
      "q_id": "Q13",
      "prompt": "Q: Kitten\nA:",
      "answer": " Cat",
      "target_id": 17810,
      "target_token": "\u0120Cat",
      "leading_space": true,
      "used_id": 17810,
      "used_token": "\u0120Cat",
      "pred_id_base": 358,
      "pred_id_with": 17810,
      "accuracy_base": 0.0,
      "accuracy_with": 1.0,
      "delta_acc": 1.0,
      "logit_base": 11.28125,
      "logit_with": 15.453125,
      "delta_logit": 4.171875,
      "logprob_base": -3.838653564453125,
      "logprob_with": -0.7843132019042969,
      "delta_logprob": 3.054340362548828,
      "p_base": 0.021522559225559235,
      "p_with": 0.45643308758735657,
      "delta_p": 0.43491052836179733
    },
    {
      "idx": 4,
      "q_id": "Q13",
      "prompt": "Q: Girl\nA:",
      "answer": " Woman",
      "target_id": 25525,
      "target_token": "\u0120Woman",
      "leading_space": true,
      "used_id": 25525,
      "used_token": "\u0120Woman",
      "pred_id_base": 358,
      "pred_id_with": 16576,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 9.3125,
      "logit_with": 13.9296875,
      "delta_logit": 4.6171875,
      "logprob_base": -4.356292724609375,
      "logprob_with": -2.45855712890625,
      "delta_logprob": 1.897735595703125,
      "p_base": 0.012825848534703255,
      "p_with": 0.08555831015110016,
      "delta_p": 0.0727324616163969
    },
    {
      "idx": 5,
      "q_id": "Q13",
      "prompt": "Q: tadpole\nA:",
      "answer": " frog",
      "target_id": 60981,
      "target_token": "\u0120frog",
      "leading_space": true,
      "used_id": 60981,
      "used_token": "\u0120frog",
      "pred_id_base": 362,
      "pred_id_with": 60981,
      "accuracy_base": 0.0,
      "accuracy_with": 1.0,
      "delta_acc": 1.0,
      "logit_base": 9.6328125,
      "logit_with": 14.046875,
      "delta_logit": 4.4140625,
      "logprob_base": -5.406878471374512,
      "logprob_with": -1.460921287536621,
      "delta_logprob": 3.9459571838378906,
      "p_base": 0.004485620651394129,
      "p_with": 0.23202241957187653,
      "delta_p": 0.2275367989204824
    },
    {
      "idx": 6,
      "q_id": "Q13",
      "prompt": "Q: Cub\nA:",
      "answer": " Bear",
      "target_id": 24941,
      "target_token": "\u0120Bear",
      "leading_space": true,
      "used_id": 24941,
      "used_token": "\u0120Bear",
      "pred_id_base": 220,
      "pred_id_with": 43692,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 7.61328125,
      "logit_with": 10.75,
      "delta_logit": 3.13671875,
      "logprob_base": -7.1617231369018555,
      "logprob_with": -4.87094783782959,
      "delta_logprob": 2.2907752990722656,
      "p_base": 0.000775716791395098,
      "p_with": 0.007666095159947872,
      "delta_p": 0.006890378368552774
    },
    {
      "idx": 7,
      "q_id": "Q13",
      "prompt": "Q: Joey\nA:",
      "answer": " Kangaroo",
      "target_id": 55376,
      "target_token": "\u0120Kang",
      "leading_space": true,
      "used_id": 55376,
      "used_token": "\u0120Kang",
      "pred_id_base": 55835,
      "pred_id_with": 55835,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 2.943359375,
      "logit_with": 3.740234375,
      "delta_logit": 0.796875,
      "logprob_base": -12.02082633972168,
      "logprob_with": -11.275032997131348,
      "delta_logprob": 0.745793342590332,
      "p_base": 6.01757437834749e-06,
      "p_with": 1.268572759727249e-05,
      "delta_p": 6.668153218924999e-06
    },
    {
      "idx": 8,
      "q_id": "Q13",
      "prompt": "Q: Foal\nA:",
      "answer": " Horse",
      "target_id": 34392,
      "target_token": "\u0120Horse",
      "leading_space": true,
      "used_id": 34392,
      "used_token": "\u0120Horse",
      "pred_id_base": 362,
      "pred_id_with": 64898,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 10.359375,
      "logit_with": 13.71875,
      "delta_logit": 3.359375,
      "logprob_base": -4.866695404052734,
      "logprob_with": -2.6054420471191406,
      "delta_logprob": 2.2612533569335938,
      "p_base": 0.007698764558881521,
      "p_with": 0.07387048006057739,
      "delta_p": 0.06617171550169587
    },
    {
      "idx": 9,
      "q_id": "Q13",
      "prompt": "Q: Fawn\nA:",
      "answer": " Deer",
      "target_id": 64191,
      "target_token": "\u0120Deer",
      "leading_space": true,
      "used_id": 64191,
      "used_token": "\u0120Deer",
      "pred_id_base": 578,
      "pred_id_with": 435,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 10.6015625,
      "logit_with": 12.7890625,
      "delta_logit": 2.1875,
      "logprob_base": -4.734657287597656,
      "logprob_with": -3.3230953216552734,
      "delta_logprob": 1.4115619659423828,
      "p_base": 0.008785459212958813,
      "p_with": 0.036041099578142166,
      "delta_p": 0.027255640365183353
    }
  ]
}