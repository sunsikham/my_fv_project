{
  "config": {
    "model": "/mnt/ebs/.hf_cache/hub/models--meta-llama--Llama-3.1-8B/snapshots/d04e592bb4f6aa9cfee91e2e20afa771667e1d4b",
    "model_spec": "llama3",
    "edit_layer": 9,
    "fv_source": "fv_global_resid",
    "seed": 0,
    "n_eval": 5,
    "answer_first_token": "auto",
    "alpha": 1.0,
    "dtype": "fp16",
    "device": "cuda",
    "batch_size": 1,
    "score_key": "mean_delta_logprob"
  },
  "fv": {
    "shape": [
      4096
    ],
    "norm": 5.359375
  },
  "summary": {
    "acc_base": 0.0,
    "acc_with": 0.6,
    "delta_acc": 0.6,
    "mean_logit_base": 5.60859375,
    "mean_logit_with": 8.179296875,
    "mean_delta_logit": 2.570703125,
    "std_delta_logit": 1.1829402073560977,
    "mean_logprob_base": -6.913025856018066,
    "mean_logprob_with": -4.235582542419434,
    "mean_delta_logprob": 2.6774433135986326,
    "std_delta_logprob": 0.9212125802859508,
    "mean_p_base": 0.002679177192840143,
    "mean_p_with": 0.07160581924690632,
    "mean_delta_p": 0.06892664205406618,
    "std_delta_p": 0.05263810126437342
  },
  "per_qid": {
    "None": {
      "n_eval": 5,
      "acc_base": 0.0,
      "acc_with": 0.6,
      "delta_acc": 0.6,
      "mean_delta_logit": 2.570703125,
      "mean_delta_logprob": 2.6774433135986326,
      "mean_delta_p": 0.06892664205406618,
      "std_delta_logit": 1.1829402073560977,
      "std_delta_logprob": 0.9212125802859508,
      "std_delta_p": 0.05263810126437342
    }
  },
  "matrix": {
    "__global__": {
      "None": 2.6774433135986326
    }
  },
  "metadata": {
    "model": "/mnt/ebs/.hf_cache/hub/models--meta-llama--Llama-3.1-8B/snapshots/d04e592bb4f6aa9cfee91e2e20afa771667e1d4b",
    "model_spec": "llama3",
    "edit_layer": 9,
    "injection_point": "residual",
    "slot": "query_predictive",
    "slot_name": "query_predictive",
    "slot_index_rule": "s=len(tokenize(prefix_str)); slot_index=s-1; target_id=input_ids[s]",
    "token_rule": "t_idx = seq_len - 1 (last token of prefix)",
    "score_key": "mean_delta_logprob",
    "heads": [
      {
        "layer": 13,
        "head": 27,
        "score_key": "mean_delta_p",
        "rank_score": 0.046491050720214845,
        "mean_delta_logprob": 1.2623046875,
        "mean_delta_p": 0.046491050720214845,
        "n_trials": 5
      },
      {
        "layer": 15,
        "head": 17,
        "score_key": "mean_delta_p",
        "rank_score": 0.03538026809692383,
        "mean_delta_logprob": 0.7275390625,
        "mean_delta_p": 0.03538026809692383,
        "n_trials": 5
      },
      {
        "layer": 16,
        "head": 29,
        "score_key": "mean_delta_p",
        "rank_score": 0.024605751037597656,
        "mean_delta_logprob": 0.7166015625,
        "mean_delta_p": 0.024605751037597656,
        "n_trials": 5
      },
      {
        "layer": 15,
        "head": 19,
        "score_key": "mean_delta_p",
        "rank_score": 0.010204124450683593,
        "mean_delta_logprob": 0.1896484375,
        "mean_delta_p": 0.010204124450683593,
        "n_trials": 5
      },
      {
        "layer": 15,
        "head": 1,
        "score_key": "mean_delta_p",
        "rank_score": 0.008336448669433593,
        "mean_delta_logprob": 0.2078125,
        "mean_delta_p": 0.008336448669433593,
        "n_trials": 5
      },
      {
        "layer": 13,
        "head": 31,
        "score_key": "mean_delta_p",
        "rank_score": 0.008037948608398437,
        "mean_delta_logprob": 0.262890625,
        "mean_delta_p": 0.008037948608398437,
        "n_trials": 5
      },
      {
        "layer": 10,
        "head": 5,
        "score_key": "mean_delta_p",
        "rank_score": 0.007324600219726562,
        "mean_delta_logprob": 0.60625,
        "mean_delta_p": 0.007324600219726562,
        "n_trials": 5
      },
      {
        "layer": 15,
        "head": 16,
        "score_key": "mean_delta_p",
        "rank_score": 0.006506538391113282,
        "mean_delta_logprob": 0.1060546875,
        "mean_delta_p": 0.006506538391113282,
        "n_trials": 5
      },
      {
        "layer": 11,
        "head": 29,
        "score_key": "mean_delta_p",
        "rank_score": 0.005735015869140625,
        "mean_delta_logprob": 0.151171875,
        "mean_delta_p": 0.005735015869140625,
        "n_trials": 5
      },
      {
        "layer": 14,
        "head": 29,
        "score_key": "mean_delta_p",
        "rank_score": 0.004794120788574219,
        "mean_delta_logprob": 0.1556640625,
        "mean_delta_p": 0.004794120788574219,
        "n_trials": 5
      }
    ],
    "seed": 0,
    "n_eval": 5,
    "alpha": 1.0,
    "fv_source": "fv_global_resid",
    "fv_type": "global",
    "fv_source_qid": null,
    "eval_scope": "all_qids",
    "eval_qids": [
      "None"
    ],
    "config": {
      "n_heads": 32,
      "head_dim": 128,
      "resid_dim": 4096,
      "hook_type": "pre",
      "reshape": "resid_to_heads",
      "hook_target": "model.layers.{layer}.self_attn.o_proj",
      "dtype": "fp16",
      "device": "cuda",
      "batch_size": 1
    },
    "fv": {
      "shape": [
        4096
      ],
      "norm": 5.359375
    },
    "fv_meta": {
      "spec_name": "llama3",
      "model": "/mnt/ebs/.hf_cache/hub/models--meta-llama--Llama-3.1-8B/snapshots/d04e592bb4f6aa9cfee91e2e20afa771667e1d4b",
      "run_id_stepD": null,
      "heads": [
        {
          "layer": 13,
          "head": 27,
          "score_key": "mean_delta_p",
          "rank_score": 0.046491050720214845,
          "mean_delta_logprob": 1.2623046875,
          "mean_delta_p": 0.046491050720214845,
          "n_trials": 5
        },
        {
          "layer": 15,
          "head": 17,
          "score_key": "mean_delta_p",
          "rank_score": 0.03538026809692383,
          "mean_delta_logprob": 0.7275390625,
          "mean_delta_p": 0.03538026809692383,
          "n_trials": 5
        },
        {
          "layer": 16,
          "head": 29,
          "score_key": "mean_delta_p",
          "rank_score": 0.024605751037597656,
          "mean_delta_logprob": 0.7166015625,
          "mean_delta_p": 0.024605751037597656,
          "n_trials": 5
        },
        {
          "layer": 15,
          "head": 19,
          "score_key": "mean_delta_p",
          "rank_score": 0.010204124450683593,
          "mean_delta_logprob": 0.1896484375,
          "mean_delta_p": 0.010204124450683593,
          "n_trials": 5
        },
        {
          "layer": 15,
          "head": 1,
          "score_key": "mean_delta_p",
          "rank_score": 0.008336448669433593,
          "mean_delta_logprob": 0.2078125,
          "mean_delta_p": 0.008336448669433593,
          "n_trials": 5
        },
        {
          "layer": 13,
          "head": 31,
          "score_key": "mean_delta_p",
          "rank_score": 0.008037948608398437,
          "mean_delta_logprob": 0.262890625,
          "mean_delta_p": 0.008037948608398437,
          "n_trials": 5
        },
        {
          "layer": 10,
          "head": 5,
          "score_key": "mean_delta_p",
          "rank_score": 0.007324600219726562,
          "mean_delta_logprob": 0.60625,
          "mean_delta_p": 0.007324600219726562,
          "n_trials": 5
        },
        {
          "layer": 15,
          "head": 16,
          "score_key": "mean_delta_p",
          "rank_score": 0.006506538391113282,
          "mean_delta_logprob": 0.1060546875,
          "mean_delta_p": 0.006506538391113282,
          "n_trials": 5
        },
        {
          "layer": 11,
          "head": 29,
          "score_key": "mean_delta_p",
          "rank_score": 0.005735015869140625,
          "mean_delta_logprob": 0.151171875,
          "mean_delta_p": 0.005735015869140625,
          "n_trials": 5
        },
        {
          "layer": 14,
          "head": 29,
          "score_key": "mean_delta_p",
          "rank_score": 0.004794120788574219,
          "mean_delta_logprob": 0.1556640625,
          "mean_delta_p": 0.004794120788574219,
          "n_trials": 5
        }
      ],
      "token_position_rule": "t_idx = seq_len - 1 (last token of prefix)"
    },
    "timestamp": "2026-02-10T18:41:48.790343Z"
  },
  "results": [
    {
      "idx": 0,
      "q_id": "None",
      "prompt": "Q: muff\nA:",
      "answer": " sharp",
      "target_id": 17676,
      "target_token": "\u0120sharp",
      "leading_space": true,
      "used_id": 17676,
      "used_token": "\u0120sharp",
      "pred_id_base": 386,
      "pred_id_with": 55404,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 2.11328125,
      "logit_with": 2.568359375,
      "delta_logit": 0.455078125,
      "logprob_base": -11.070082664489746,
      "logprob_with": -10.104931831359863,
      "delta_logprob": 0.9651508331298828,
      "p_base": 1.5571275071124546e-05,
      "p_with": 4.0877457649912685e-05,
      "delta_p": 2.530618257878814e-05
    },
    {
      "idx": 1,
      "q_id": "None",
      "prompt": "Q: exclude\nA:",
      "answer": " include",
      "target_id": 2997,
      "target_token": "\u0120include",
      "leading_space": true,
      "used_id": 2997,
      "used_token": "\u0120include",
      "pred_id_base": 22429,
      "pred_id_with": 2997,
      "accuracy_base": 0.0,
      "accuracy_with": 1.0,
      "delta_acc": 1.0,
      "logit_base": 6.30078125,
      "logit_with": 9.7421875,
      "delta_logit": 3.44140625,
      "logprob_base": -5.47906494140625,
      "logprob_with": -2.1540355682373047,
      "delta_logprob": 3.3250293731689453,
      "p_base": 0.004173229914158583,
      "p_with": 0.11601503193378448,
      "delta_p": 0.1118418020196259
    },
    {
      "idx": 2,
      "q_id": "None",
      "prompt": "Q: dusty\nA:",
      "answer": " clean",
      "target_id": 4335,
      "target_token": "\u0120clean",
      "leading_space": true,
      "used_id": 4335,
      "used_token": "\u0120clean",
      "pred_id_base": 358,
      "pred_id_with": 578,
      "accuracy_base": 0.0,
      "accuracy_with": 0.0,
      "delta_acc": 0.0,
      "logit_base": 7.02734375,
      "logit_with": 9.1015625,
      "delta_logit": 2.07421875,
      "logprob_base": -7.057851791381836,
      "logprob_with": -4.610874176025391,
      "delta_logprob": 2.4469776153564453,
      "p_base": 0.0008606249466538429,
      "p_with": 0.00994312297552824,
      "delta_p": 0.009082498028874397
    },
    {
      "idx": 3,
      "q_id": "None",
      "prompt": "Q: exclude\nA:",
      "answer": " include",
      "target_id": 2997,
      "target_token": "\u0120include",
      "leading_space": true,
      "used_id": 2997,
      "used_token": "\u0120include",
      "pred_id_base": 22429,
      "pred_id_with": 2997,
      "accuracy_base": 0.0,
      "accuracy_with": 1.0,
      "delta_acc": 1.0,
      "logit_base": 6.30078125,
      "logit_with": 9.7421875,
      "delta_logit": 3.44140625,
      "logprob_base": -5.47906494140625,
      "logprob_with": -2.1540355682373047,
      "delta_logprob": 3.3250293731689453,
      "p_base": 0.004173229914158583,
      "p_with": 0.11601503193378448,
      "delta_p": 0.1118418020196259
    },
    {
      "idx": 4,
      "q_id": "None",
      "prompt": "Q: exclude\nA:",
      "answer": " include",
      "target_id": 2997,
      "target_token": "\u0120include",
      "leading_space": true,
      "used_id": 2997,
      "used_token": "\u0120include",
      "pred_id_base": 22429,
      "pred_id_with": 2997,
      "accuracy_base": 0.0,
      "accuracy_with": 1.0,
      "delta_acc": 1.0,
      "logit_base": 6.30078125,
      "logit_with": 9.7421875,
      "delta_logit": 3.44140625,
      "logprob_base": -5.47906494140625,
      "logprob_with": -2.1540355682373047,
      "delta_logprob": 3.3250293731689453,
      "p_base": 0.004173229914158583,
      "p_with": 0.11601503193378448,
      "delta_p": 0.1118418020196259
    }
  ]
}